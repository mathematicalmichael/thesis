#FROM continuumio/miniconda3:4.8.2
FROM mambaorg/micromamba:0.27.0-bullseye
USER root
ARG MAMBA_DOCKERFILE_ACTIVATE=1

# 3.10 seems to be the latest supported Python as of 2022-10
RUN micromamba install -c conda-forge -y python=3.10

### Install package from source
# bet - dependencies for inverse problem
RUN pip install bet==2.3.0
#COPY install_bet.sh /tmp/

# need git to install from source
# tree allows printing directories in command-line
#RUN apt-get --allow-releaseinfo-change update && \
#	apt-get install -y \
# 	build-essential \
#	git \
#	&& sh /tmp/install_bet.sh \
#	&& apt-get remove git -y \
#	&& apt-get clean \
#	&& rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \
#	&& apt-get autoremove -y

RUN micromamba install -c conda-forge -y fenics
# formatting tools for scripts, notebooks
RUN pip install \
	nbconvert \
	mud~=0.0.6
	#pyprind  \
	#autopep8 \
	#black \

WORKDIR /temp
ENV LD_LIBRARY_PATH /opt/conda/lib:$LD_LIBRARY_PATH

CMD ["python"]
